/*! angular-magnificent - v0.1.1 - 2016-06-17
* https://github.com/kjakub/angular-magnificent
* Copyright (c) 2016 Manuel Ramirez - Pixeleur; Licensed MIT */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="angular-magnificent"),function(a){"use strict";var b=a.module("angular-magnificent",[]);b.constant("defaults",{enabled:!0,interval:5,current:0,mouseMove:null}),b.directive("magnificent",["$window","$timeout","$interval",function(b,c,d){var e='<ul class="magnificent-slider"><li ng-repeat="slide in magnificent.slides track by $index"><div slide-src="{{slide.src}}" picture-id="{{slide.id}}" id="slide{{$index}}"  class="magnificent-loading magnificent-fadein magnificent-fadeout" ng-show="magnificent.current==$index" preload></div></li></ul>';return{restrict:"E",template:e,scope:{magnificent:"="},controller:["$scope","defaults",function(b,c){a.extend(c,b.magnificent.settings),b.magnificent.settings=c,b.interval=1e3*b.magnificent.settings.interval}],link:function(e,f,g){"undefined"!=typeof e.magnificent.mouseMove&&a.element(document.body).bind("mousemove",function(a){e.magnificent.mouseMove(a)}),a.element(b).bind("resize",function(){c(function(){},0)});var h=function(a,b){c(function(){return(" "+f.className+" ").indexOf(" "+b+" ")>-1})},i=function(a){var b=document.getElementById("slide"+a);return b.getAttribute("picture-id")},j=d(function(){var a=document.getElementById("slide"+e.magnificent.current);return!e.magnificent.settings.enabled||h(a,"magnificent-loading")?void console.log("still not ready"):void(e.magnificent.slides.length>0?e.magnificent.current===e.magnificent.slides.length-1?(e.magnificent.slideUpdate(i(e.magnificent.current),!0,!1),e.magnificent.current=0):(e.magnificent.slideUpdate(i(e.magnificent.current),!1,!1),e.magnificent.current++):e.magnificent.slideUpdate(null,null,!0))},e.interval,0);f.on("$destroy",function(){d.cancel(j)}),e.getPath=function(){var b,c,d,e=document.getElementsByTagName("script"),f="angular-magnificent.min.js";a.forEach(e,function(a,e){b=a,c=b.src.substring(b.src.length-f.length),c===f&&(d=e)}),b=e[d];var g=b.src;return g.replace(f,"angular-magnificent.min.css")},e.linkStyle=function(){var b=e.getPath(),c=!1,d=document.getElementsByTagName("head")[0];if(a.forEach(d.childNodes,function(a,d){a.src===b&&(c=!0)}),!c){var f=document.createElement("link");f.type="text/css",f.rel="stylesheet",f.href=b,d.appendChild(f)}},e.linkStyle()}}}]),b.factory("loader",function(){return function(b,c,d){return a.element(new Image).bind("load",function(){c()}).bind("error",function(){d()}).attr("src",b)}}),b.directive("preload",["loader",function(a){return{restrict:"A",scope:!0,link:function(b,c,d){d.slideSrc;d.$observe("slideSrc",function(b){c.addClass("magnificent-loading"),c.removeClass("magnificent-slide");a(b,function(){c.css({"background-image":"url("+b+")"}),c.removeClass("magnificent-loading"),c.addClass("magnificent-slide")},function(){console.log("failed")})})}}}])}(angular);